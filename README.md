# ğŸ¬ IMDB Analyzer â€” Sentiment Analysis + RAG + LoRA Fine-Tuning
**Hackathon Project â€” Real-Time Movie Review Understanding & Contextual Responses**

This project implements a complete **Retrieval-Augmented Generation (RAG)** system combined with a **fine-tuned sentiment classifier** using **Parameter-Efficient Fine-Tuning (LoRA)**.

A Streamlit UI guides the user through:
1. Choosing a movie title  
2. Entering a review  
3. Receiving:  
   - Sentiment classification  
   - Retrieved similar IMDB reviews  
   - A contextual AI-generated response  

---

## âœ¨ Features

### ğŸ” Sentiment Analysis (LoRA Fine-Tuned)
- Fine-tuned lightweight transformer model (`distilroberta-base`)
- Efficient LoRA training (low compute, no GPU needed)
- Trained once and loaded automatically for inference

### ğŸ“š RAG System (Retrieval-Augmented Generation)
- Embeds all IMDB reviews using Sentence Transformers
- FAISS-based similarity search retrieves context for each user review
- Prompts a generative model (`microsoft/phi-2`) using retrieved evidence

### ğŸ§  Context-Aware Response Generation
- The system blends:
  - User sentiment  
  - Retrieved IMDB reviews  
  - Personalized guidance  
- Produces coherent, movie-specific responses

### ğŸ–¥ï¸ Streamlit Web UI
- Guided 3-step workflow  
- Real-time processing  
- Clean and simple interface  
- Works on CPU  

---

## ğŸš€ Project Structure

```
IMDB-Analyzer/
â”‚
â”œâ”€â”€ imdb_analyzer/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ data.py
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ classifier.py
â”‚   â”œâ”€â”€ rag/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ embedder.py
â”‚   â”‚   â”œâ”€â”€ retriever.py
â”‚   â”‚   â”œâ”€â”€ prompt_builder.py
â”‚   â”‚   â”œâ”€â”€ rag_pipeline.py
â”‚   â”œâ”€â”€ configs/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ training_config.py
â”‚   â”‚   â””â”€â”€ rag_config.py
â”‚   â””â”€â”€ ui/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ app.py
â”‚
â”œâ”€â”€ main.py
â””â”€â”€ README.md
```

---

## âš™ï¸ Installation

### 1. Clone the repository
```bash
git clone https://github.com/YOUR_USERNAME/IMDB-Analyzer.git
cd IMDB-Analyzer
```

### 2. Create a virtual environment
```bash
python3 -m venv .venv
source .venv/bin/activate
```

### 3. Install dependencies
```bash
pip install -r requirements.txt
```

---

## ğŸ¯ Usage

### ğŸ§ª Run the CLI Version
```bash
python main.py
```

This will:
- Load the dataset  
- Train or load the sentiment classifier  
- Build embeddings + FAISS index  
- Allow you to test the pipeline in terminal  

---

### ğŸ–¥ï¸ Run the Web UI (Streamlit)

```bash
python -m streamlit run imdb_analyzer/ui/app.py
```

This launches an interactive 3-step web application:

1. Choose a movie title  
2. Enter your review  
3. Receive sentiment + contextual AI response  

---

## ğŸ‹ï¸ Training the Sentiment Classifier

The classifier uses LoRA fine-tuning with the following configuration:

```python
TRAINING_CONFIG = {
    "model_name": "distilroberta-base",
    "lora_r": 8,
    "lora_alpha": 16,
    "lora_dropout": 0.1,
    "batch_size": 8,
    "learning_rate": 1e-4,
    "num_epochs": 3,
    "output_dir": "sentiment_lora_model"
}
```

Training happens **only once** â€” if the model directory already exists, it is automatically reused.

---

## ğŸ” RAG Pipeline Overview

The RAG pipeline performs:

1. **Sentiment classification**
2. **Sentence embedding of the user review**
3. **FAISS similarity search among IMDB reviews**
4. **Prompt building including:**
   - Movie title  
   - User review  
   - Sentiment  
   - Retrieved context  
5. **Generation using Microsoft Phi-2**

All logic is encapsulated in:

```python
from imdb_analyzer.rag import RAGPipeline
```

---

## ğŸ§  Technologies Used

| Component | Technology |
|----------|------------|
| Sentiment Model | DistilRoBERTa + LoRA |
| Embeddings | Sentence Transformers |
| Vector Search | FAISS |
| Generator | Microsoft Phi-2 |
| UI | Streamlit |
| Dataset | IMDB Reviews |

---

## ğŸ§ª Example Prompt Generated by the System

```
You are a movie discussion assistant.
The user has selected the movie: "Inception".

User sentiment: positive
User review: "Loved the visuals but the pacing felt slow."

Here are some related reviews:
- "The movie's visuals are exceptional..."
- "Some viewers found the pacing slow..."

Using the above context, generate a coherent, friendly response.
```

---

## ğŸ› ï¸ Troubleshooting

### âŒ ModuleNotFoundError: No module named 'data'
Run Streamlit from the project root:

```bash
python -m streamlit run imdb_analyzer/ui/app.py
```

Ensure the folder structure matches this README.

### âŒ MPS device / Apple Silicon errors
Sentiment classifier is forced to run on CPU to avoid PyTorch MPS bugs.

---

## ğŸ“œ License
MIT License

---

## ğŸ™Œ Acknowledgements
- Hugging Face Transformers  
- Sentence Transformers  
- Streamlit  
- FAISS  
- IMDB Dataset  
